from difflib import SequenceMatcher

# ë²ˆí˜¸ ì •ì œ í•¨ìˆ˜
def clean_number(number):
    return ''.join(filter(str.isdigit, number))

# ë™ì•„ëŒ€í•™êµ í•™ê³¼ ëŒ€í‘œ ë²ˆí˜¸
special_numbers = {
    '0512007776': "ë™ì•„ëŒ€í•™êµ ì»´í“¨í„°ê³µí•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007775': "ë™ì•„ëŒ€í•™êµ AIí•™ê³¼ì…ë‹ˆë‹¤.",
    '0512008651': "ë™ì•„ëŒ€í•™êµ ì •ë³´í†µê³„í•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007620': "ë™ì•„ëŒ€í•™êµ ì „ìê³µí•™ê³¼ ë˜ëŠ” í† ëª©ê³µí•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007659': "ë™ì•„ëŒ€í•™êµ ê¸°ê³„ê³µí•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007618': "ë™ì•„ëŒ€í•™êµ ê±´ì¶•í•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007717': "ë™ì•„ëŒ€í•™êµ í™”í•™ê³µí•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007732': "ë™ì•„ëŒ€í•™êµ ì „ê¸°ê³µí•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007674': "ë™ì•„ëŒ€í•™êµ í™˜ê²½ê³µí•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007747': "ë™ì•„ëŒ€í•™êµ ê¸ˆì†ê³µí•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007571': "ë™ì•„ëŒ€í•™êµ ì¡°ê²½í•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007662': "ë™ì•„ëŒ€í•™êµ ë„ì‹œê³„íší•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007787': "ë™ì•„ëŒ€í•™êµ ì¡°ì„ í•´ì–‘í”ŒëœíŠ¸ê³µí•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007851': "ë™ì•„ëŒ€í•™êµ ì²´ìœ¡í•™ê³¼ ë˜ëŠ” ìŠ¤í¬ì¸ ì˜í•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007856': "ë™ì•„ëŒ€í•™êµ íƒœê¶Œë„í•™ê³¼ì…ë‹ˆë‹¤.",
    '0512001740': "ë™ì•„ëŒ€í•™êµ ë¯¸ìˆ í•™ê³¼ì…ë‹ˆë‹¤.",
    '0512001758': "ë™ì•„ëŒ€í•™êµ ìŒì•…í•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007980': "ë™ì•„ëŒ€í•™êµ ì¡°í˜•ë””ìì¸í•™ê³¼ì…ë‹ˆë‹¤.",
    '0512402925': "ë™ì•„ëŒ€í•™êµ ì˜í•™ê³¼ ë˜ëŠ” ì¤‘ê°œì˜ê³¼í•™ê³¼ì…ë‹ˆë‹¤.",
    '0512008558': "ë™ì•„ëŒ€í•™êµ êµ­ì œë²•ë¬´í•™ê³¼ì…ë‹ˆë‹¤.",
    '0512008753': "ë™ì•„ëŒ€í•™êµ ê¸°ì—…ì •ì±…í•™ê³¼ì…ë‹ˆë‹¤.",
    '0512007606': "ë™ì•„ëŒ€í•™êµ ICTìœµí•©í•´ì–‘ìŠ¤ë§ˆíŠ¸ì‹œí‹°ê³µí•™ê³¼ì…ë‹ˆë‹¤."
}

# ìŠ¤íŒ¸ ë²ˆí˜¸ (010 ì œì™¸, ì´ 101ê°œ)
spam_numbers = [
    '0266086107', '6788428522', '07076166054', '0266087709', '07070794441',
    '0260491704', '0233165588', '0220687943', '0222115600', '025671853',
    '0234242406', '07078895983', '0263290330', '0237003333', '07079193327',
    '0221391783', '15991155', '15779990', '0262928025', '027040387',
    '0262950016', '01198196199', '0232104794', '024228002', '0314779579',
    '024187744', '0226130184', '0269262850', '024204489', '027040172',
    '070788957490', '0268468681', '0263639340', '0215774715', '027340268',
    '15888114', '15888585', '15880079', '15886200', '15886565', '0237796114',
    '15883500', '15662566', '15881599', '15998000', '15881500', '15882100',
    '15442100', '15885000', '15995000', '15881111', '15889999', '15887000',
    '15881515', '15885050', '15883388', '15884477', '15441120', '0222115513',
    '0215779990', '029938578', '0234540687', '0269582570', '0707665',
    '07076656637', '07076656638', '027420173', '0237825950', '0216990010',
    '16700947', '15882788', '027388015', '07076623224', '07098760109',
    '025673311', '07098763013', '0260210560', '0234073600', '07076844316',
    '0222684837', '15885005', '0226310862', '0216706820', '0220982336',
    '015992831', '0269530794', '027854401', '0233918470', '0234781987',
    '0220911627', '025545623', '0220911626', '0220911629', '029512001',
    '029512005', '025381713', '0230199596', '025730903', '05074169375',
    '0269530792', '0269530793'
]

# ğŸ“Š íŒë‹¨ í•¨ìˆ˜
def is_spam_or_special(user_number, spam_list, threshold_high=0.95, threshold_mid=0.7):
    user_digits = clean_number(user_number)

    # âœ… ë™ì•„ëŒ€ íŠ¹ìˆ˜ ë²ˆí˜¸ í™•ì¸
    if user_digits in special_numbers:
        return special_numbers[user_digits], 1.0

    # âœ… íœ´ëŒ€í° ì œì™¸
    if user_digits.startswith("010"):
        return "âœ… 010ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë²ˆí˜¸ëŠ” ê°œì¸ë²ˆí˜¸ì´ë¯€ë¡œ ê²€ì‚¬ ëŒ€ìƒì—ì„œ ì œì™¸ë©ë‹ˆë‹¤.", 0.0

    # âœ… ë²ˆí˜¸ íŒ¨í„´ ê²½ê³ 
    if user_digits.startswith("02") and len(user_digits) > 2 and user_digits[2] in {'2', '3', '6'}:
        return "ğŸ”´ ìŠ¤íŒ¸ ê°€ëŠ¥ì„± ë†’ìŒ (02-2/3/6x êµ­ë²ˆ)", 1.0
    if user_digits.startswith("070") and len(user_digits) > 3 and user_digits[3] in {'4', '7', '8'}:
        return "ğŸ”´ ìŠ¤íŒ¸ ê°€ëŠ¥ì„± ë§¤ìš° ë†’ìŒ (070-4/7/8 ëŒ€ì—­)", 1.0

    # âœ… ìœ ì‚¬ë„ ê³„ì‚°
    max_similarity = 0.0
    for spam in spam_list:
        score = SequenceMatcher(None, user_digits, clean_number(spam)).ratio()
        max_similarity = max(max_similarity, score)

    # âœ… ê²°ê³¼ ë°˜í™˜
    if max_similarity >= threshold_high:
        result = "ğŸ”´ ìŠ¤íŒ¸ ê°€ëŠ¥ì„± ë§¤ìš° ë†’ìŒ"
    elif max_similarity >= threshold_mid:
        result = "ğŸŸ  ìŠ¤íŒ¸ ê°€ëŠ¥ì„± ìˆìŒ"
    else:
        result = "ğŸŸ¢ ìŠ¤íŒ¸ ê°€ëŠ¥ì„± ë‚®ìŒ"

    return result, round(max_similarity, 3)